KISSY.add("iee/my.category",function(e,t,a,s){var i={};return i.init=function(){this.el=t.get("#category"),this.render(window.categoryList),this.checkMax()},i.render=function(s){var i=this,n=i.el,c={};i.valueEl=t.get("input",n);var l={};e.each(i.valueEl.value.split(","),function(e){l[e]=!0}),e.each(s,function(e){var a=e.name.split("/"),s=c[a[0]];s||(s=t.create('<div class="item"></div>'),n.appendChild(s),c[a[0]]=s);var i=t.create("<span></span>");i.className="trigger"+(e.id in l?" selected":""),t.attr(i,"data-id",e.id),t.attr(i,"title",a.join(": ")),i.innerHTML=a.pop()+"<ins></ins>",s.appendChild(i)}),a.on(t.query("span",n),"click",function(){i.select(this)})},i.select=function(a){a.parentNode;if(t.hasClass(a,"selected"))t.removeClass(a,"selected");else{if(t.hasClass(this.el,"max"))return;t.addClass(a,"selected")}var s=[];e.each(t.query("span.selected",this.el),function(e){s.push(t.attr(e,"data-id"))}),this.valueEl.value=s.join(","),this.checkMax()},i.checkMax=function(){},i.update=function(e){s({type:"post",url:"/item/put",data:{category:this.valueEl.value,id:this.valueEl.form.elements.id.value},success:function(a){var s=t.next(e,"span.tip");s||(s=t.create('<span class="tip"></span>'),t.insertAfter(s,e));var i="文章分类更新成功！";a.success||(i=a.msg),s.innerHTML=i}})},i},{requires:["dom","event","ajax"]});