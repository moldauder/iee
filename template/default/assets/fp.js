!function(t){function i(a){if(e[a])return e[a].exports;var s=e[a]={exports:{},id:a,loaded:!1};return t[a].call(s.exports,s,s.exports,i),s.loaded=!0,s.exports}var e={};return i.m=t,i.c=e,i.p="",i(0)}([function(t,i,e){e(1),e(2);var a=e(3),s="",n=$("#waterfall");n.waterfall({itemCls:"pin",fitWidth:!0,colWidth:320,gutterWidth:20,maxCol:3,loadingMsg:'<p class="loading"><img src="//pic.yupoo.com/iewei/C6Gb0faQ/PMs7M.gif" width="202" height="70"/></p>',path:function(){return"/query/all?from=fp&cat="+(window.curCatId||"")+"&id="+s},callbacks:{loadingStart:function(t){t.show()},loadingFinished:function(t,i){i?t.html('<p class="end"></p>').show():t.fadeOut()},renderData:function(t,i){if(t.length){var e="";return $.each(t,function(t,i){s=i.id,e+='<a href="/'+("0"!==i.sid?i.sid:i.id)+'" class="pin"><img src="'+i.img+'" width="320" height="420" /><div class="extra"><div class="mask"></div>'+a.stddate(i.modified)+'<div class="title">'+i.title+'</div><div class="desc">'+i.fullcontent+'</div><div class="author"><s></s>'+i.nick+"</div></div>"+("album"===i.type?'<s class="type-album"></s>':"")+"</a>"}),e}n.data("plugin_waterfall").options.maxPage=1}}}),a.initCategory(window.subCat,window.curCatId)},function(t,i){$(function(){var t=$(window),i=$('<span class="gotop" hideFocus="true"></span>'),e="hide";(new Image).src="//pic.yupoo.com/iewei/Cam6yIZo/XryK.gif",i.click(function(){$(document.body).animate({scrollTop:0},Math.min(.2*t.scrollTop()/800,1),"linear",function(){i.css("opacity",0),e="hide"})}),i.mouseenter(function(){i.addClass("gotop-hover")}),i.mouseleave(function(){i.removeClass("gotop-hover")}),t.scroll(function(){var a=t.scrollTop();a>200&&"show"!==e?(e="show",i.animate({opacity:.9},.4,"linear"),e="show"):0===a&&"hide"!==e&&(i.animate({opacity:0},.4,"linear"),e="hide")}),i.appendTo($(document.body))})},function(t,i){/*! waterfall - v0.1.73 - 2015-12-01
	* http://wlog.cn/waterfall/
	* Copyright (c) 2015 bingdian; Licensed MIT */
!function(t,i,e,a){"use strict";function s(i,e){this.$element=t(i),this.options=t.extend(!0,{},r,e),this.colHeightArray=[],this.styleQueue=[],this._init()}var n=t(i),o="waterfall",r={itemCls:"waterfall-item",prefix:"waterfall",fitWidth:!0,colWidth:240,gutterWidth:10,gutterHeight:10,align:"center",minCol:1,maxCol:a,maxPage:a,bufferPixel:-50,containerStyle:{position:"relative"},resizable:!0,isFadeIn:!1,isAnimated:!1,animationOptions:{},isAutoPrefill:!0,checkImagesLoaded:!0,path:a,dataType:"json",params:{},headers:{},loadingMsg:'<div style="text-align:center;padding:10px 0; color:#999;"><img src="data:image/gif;base64,R0lGODlhEAALAPQAAP///zMzM+Li4tra2u7u7jk5OTMzM1hYWJubm4CAgMjIyE9PT29vb6KiooODg8vLy1JSUjc3N3Jycuvr6+Dg4Pb29mBgYOPj4/X19cXFxbOzs9XV1fHx8TMzMzMzMzMzMyH5BAkLAAAAIf4aQ3JlYXRlZCB3aXRoIGFqYXhsb2FkLmluZm8AIf8LTkVUU0NBUEUyLjADAQAAACwAAAAAEAALAAAFLSAgjmRpnqSgCuLKAq5AEIM4zDVw03ve27ifDgfkEYe04kDIDC5zrtYKRa2WQgAh+QQJCwAAACwAAAAAEAALAAAFJGBhGAVgnqhpHIeRvsDawqns0qeN5+y967tYLyicBYE7EYkYAgAh+QQJCwAAACwAAAAAEAALAAAFNiAgjothLOOIJAkiGgxjpGKiKMkbz7SN6zIawJcDwIK9W/HISxGBzdHTuBNOmcJVCyoUlk7CEAAh+QQJCwAAACwAAAAAEAALAAAFNSAgjqQIRRFUAo3jNGIkSdHqPI8Tz3V55zuaDacDyIQ+YrBH+hWPzJFzOQQaeavWi7oqnVIhACH5BAkLAAAALAAAAAAQAAsAAAUyICCOZGme1rJY5kRRk7hI0mJSVUXJtF3iOl7tltsBZsNfUegjAY3I5sgFY55KqdX1GgIAIfkECQsAAAAsAAAAABAACwAABTcgII5kaZ4kcV2EqLJipmnZhWGXaOOitm2aXQ4g7P2Ct2ER4AMul00kj5g0Al8tADY2y6C+4FIIACH5BAkLAAAALAAAAAAQAAsAAAUvICCOZGme5ERRk6iy7qpyHCVStA3gNa/7txxwlwv2isSacYUc+l4tADQGQ1mvpBAAIfkECQsAAAAsAAAAABAACwAABS8gII5kaZ7kRFGTqLLuqnIcJVK0DeA1r/u3HHCXC/aKxJpxhRz6Xi0ANAZDWa+kEAA7" alt=""><br />Loading...</div>',state:{isDuringAjax:!1,isProcessingData:!1,isResizing:!1,isPause:!1,curPage:1},callbacks:{loadingStart:function(t){t.show()},loadingFinished:function(t,i){i?t.remove():t.fadeOut()},loadingError:function(t,i){t.html("Data load faild, please try again later.")},renderData:function(i,e){var a,s;return"json"===e||"jsonp"===e?(a=t("#waterfall-tpl").html(),(s=Handlebars.compile(a))(i)):i}},debug:!1};s.prototype={constructor:s,_debug:function(){!0===this.options.debug&&("undefined"!=typeof console&&"function"==typeof console.log?1===Array.prototype.slice.call(arguments).length&&"string"==typeof Array.prototype.slice.call(arguments)[0]?console.log(Array.prototype.slice.call(arguments).toString()):console.log(Array.prototype.slice.call(arguments)):Function.prototype.bind||"undefined"==typeof console||"object"!=typeof console.log||Function.prototype.call.call(console.log,console,Array.prototype.slice.call(arguments)))},_init:function(t){var i=this.options,e=i.path;return this._setColumns(),this._initContainer(),this._resetColumnsHeightArray(),this.reLayout(t),e?(i.isAutoPrefill&&this._prefill(),i.resizable&&this._doResize(),void this._doScroll()):void this._debug("Invalid path")},_initContainer:function(){var i=this.options,e=i.prefix;t("body").css({overflow:"auto"}),this.$element.css(this.options.containerStyle).addClass(e+"-container"),this.$element.after('<div id="'+e+'-loading">'+i.loadingMsg+'</div><div id="'+e+'-message" style="text-align:center;color:#999;"></div>'),this.$loading=t("#"+e+"-loading"),this.$message=t("#"+e+"-message")},_getColumns:function(){var t=this.options,i=t.fitWidth?this.$element.parent():this.$element,e="BODY"===i[0].tagName?i.width()-20:i.width(),a=t.colWidth,s=t.gutterWidth,n=t.minCol,o=t.maxCol,r=Math.floor(e/(a+s)),l=Math.max(r,n);return o&&l>o?o:l},_setColumns:function(){this.cols=this._getColumns()},_getItems:function(t){var i=t.filter("."+this.options.itemCls).css({position:"absolute"});return i},_resetColumnsHeightArray:function(){var t,i=this.cols;for(this.colHeightArray.length=i,t=0;i>t;t++)this.colHeightArray[t]=0},layout:function(t,i){var e,a,s,n,o,r,l=this.options,c=this.options.isFadeIn?this._getItems(t).css({opacity:0}).animate({opacity:1}):this._getItems(t),h=this.options.isAnimated&&this.options.state.isResizing?"animate":"css",d=l.animationOptions,u=l.colWidth,A=l.gutterWidth,p=this.colHeightArray.length,g=l.align;for(this.$element.append(c),"center"===g?(e=(this.$element.width()-u*p-A*(p-1))/2,e=e>0?e:0):"left"===g?e=0:"right"===g&&(e=this.$element.width()-u*p-A*(p-1)),s=0,o=c.length;o>s;s++)this._placeItems(c[s],e);for(n=0,r=this.styleQueue.length;r>n;n++)a=this.styleQueue[n],a.$el[h](a.style,d);this.$element.height(Math.max.apply({},this.colHeightArray)),this.styleQueue=[],this.options.state.isResizing=!1,this.options.state.isProcessingData=!1,i&&i.call(c)},reLayout:function(t){var i=this.$element.find("."+this.options.itemCls);this._resetColumnsHeightArray(),this.layout(i,t)},_placeItems:function(i,e){var a,s,n=t(i),o=this.options,r=o.colWidth,l=o.gutterWidth,c=o.gutterHeight,h=this.colHeightArray,d=h.length,u=Math.min.apply({},h),A=t.inArray(u,h);a=n.hasClass(o.prefix+"-item-fixed-left")?0:n.hasClass(o.prefix+"-item-fixed-right")?d>1?d-1:0:A,s={left:(r+l)*a+e,top:h[a]},this.styleQueue.push({$el:n,style:s}),h[a]+=n.outerHeight()+c},prepend:function(t,i){this.$element.prepend(t),this.reLayout(i)},append:function(t,i){this.$element.append(t),this.reLayout(i)},removeItems:function(t,i){this.$element.find(t).remove(),this.reLayout(i)},option:function(i,e){t.isPlainObject(i)&&(this.options=t.extend(!0,this.options,i),"function"==typeof e&&e(),this._init())},pause:function(t){this.options.state.isPause=!0,"function"==typeof t&&t()},resume:function(t){this.options.state.isPause=!1,"function"==typeof t&&t()},_requestData:function(i){var e,s=this,n=this.options,o=n.maxPage,r=n.state.curPage++,l=n.path,c=n.dataType,h=n.params,d=n.headers;return o!==a&&r>o?(n.state.isBeyondMaxPage=!0,void n.callbacks.loadingFinished(this.$loading,n.state.isBeyondMaxPage)):(e="function"==typeof l?l(r):l.join(r),this._debug("heading into ajax",e+t.param(h)),n.callbacks.loadingStart(this.$loading),n.state.isDuringAjax=!0,n.state.isProcessingData=!0,void t.ajax({url:e,data:h,headers:d,dataType:c,success:function(t){s._handleResponse(t,i),s.options.state.isDuringAjax=!1},error:function(t){s._responeseError("error")}}))},_handleResponse:function(i,e){var a=this,s=this.options,n=t.trim(s.callbacks.renderData(i,s.dataType)),o=t(n),r=s.checkImagesLoaded;r?o.imagesLoaded(function(){a.append(o,e),a.options.callbacks.loadingFinished(a.$loading,a.options.state.isBeyondMaxPage)}):(a.append(o,e),a.options.callbacks.loadingFinished(a.$loading,a.options.state.isBeyondMaxPage))},_responeseError:function(t){this.$loading.hide(),this.options.callbacks.loadingError(this.$message,t),"end"!==t&&"error"!==t&&(t="unknown"),this._debug("Error",t)},_nearbottom:function(){var t=this.options,i=Math.min.apply({},this.colHeightArray),e=n.scrollTop()+n.height()-this.$element.offset().top-i;return this._debug("math:",e),e>t.bufferPixel},_prefill:function(){this.$element.height()<=n.height()&&this._scroll()},_scroll:function(){var t=this.options,i=t.state,e=this;i.isProcessingData||i.isDuringAjax||i.isInvalidPage||i.isPause||this._nearbottom()&&this._requestData(function(){setTimeout(function(){e._scroll()},100)})},_doScroll:function(){var t,i=this;n.bind("scroll",function(){t&&clearTimeout(t),t=setTimeout(function(){i._scroll()},100)})},_resize:function(){var t=this.cols,i=this._getColumns();(i!==t||"left"!==this.options.align)&&(this.options.state.isResizing=!0,this.cols=i,this.reLayout(),this._prefill())},_doResize:function(){var t,i=this;n.bind("resize",function(){t&&clearTimeout(t),t=setTimeout(function(){i._resize()},100)})}},t.fn[o]=function(i){if("string"==typeof i){var e=Array.prototype.slice.call(arguments,1);this.each(function(){var a=t.data(this,"plugin_"+o);return a?t.isFunction(a[i])&&"_"!==i.charAt(0)?void a[i].apply(a,e):void a._debug('no such method "'+i+'"'):void a._debug("instance is not initialization")})}else this.each(function(){t.data(this,"plugin_"+o)||t.data(this,"plugin_"+o,new s(this,i))});return this}}(jQuery,window,document),function(t,i){"use strict";var e="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";t.fn.imagesLoaded=function(a){function s(){var i=t(u),e=t(A);l&&(A.length?l.reject(h,i,e):l.resolve(h)),t.isFunction(a)&&a.call(r,h,i,e)}function n(t){o(t.target,"error"===t.type)}function o(i,a){i.src!==e&&-1===t.inArray(i,d)&&(d.push(i),a?A.push(i):u.push(i),t.data(i,"imagesLoaded",{isBroken:a,src:i.src}),c&&l.notifyWith(t(i),[a,h,t(u),t(A)]),h.length===d.length&&(setTimeout(s),h.unbind(".imagesLoaded",n)))}var r=this,l=t.isFunction(t.Deferred)?t.Deferred():0,c=t.isFunction(l.notify),h=r.find("img").add(r.filter("img")),d=[],u=[],A=[];return t.isPlainObject(a)&&t.each(a,function(t,i){"callback"===t?a=i:l&&l[t](i)}),h.length?h.bind("load.imagesLoaded error.imagesLoaded",n).each(function(a,s){var n=s.src,r=t.data(s,"imagesLoaded");return r&&r.src===n?void o(s,r.isBroken):s.complete&&s.naturalWidth!==i?void o(s,0===s.naturalWidth||0===s.naturalHeight):void((s.readyState||s.complete)&&(s.src=e,s.src=n))}):s(),l?l.promise(r):r}}(jQuery)},function(t,i){var e=["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"];i.stddate=function(t){var i=t.split(" ")[0].split("-");if(3===i.length){var a=i[1]-1;return a>-1&&12>a&&(i[1]=e[a]),'<div class="stddate"><span class="day">'+i[2]+'</span><span class="month">'+i[1]+'</span><span class="year">'+i[0]+"</span></div>"}return""},i.filterHtmlTag=function(t){var i=document.createElement("div");return i.innerHTML=t,DOM.text(i)},i.initCategory=function(t,i){var e=$("#category"),a=$('<div class="category-placeholder"></div>');a.insertBefore(e);var s,n=e.find("div.sub"),o=function(e){var a=t[e.attr("data-cat")];if($.isArray(a)||0!==a.length){var o=e.data("isExpand");if(o){var r=n.find("div.sub-cat");r.length&&r.animate({marginTop:0-r.outerHeight()},.5),s=null}else{if("color"===a[0].type){var l='<div class="sub-cat sub-cat-color"><div class="list">';$.each(a,function(t,e){l+='<a target="_self" class="cat-'+e.alias+(i===e.id?" active":"")+'" href="?cat='+e.alias+'"><span>'+e.name.substr(e.name.indexOf("/")+1)+"</span></a>"}),l+="</div></div>"}n.html(l);var r=n.find("div.sub-cat"),c=r.outerHeight();r.css("marginTop",0-c),n.css("height",c),r.animate({marginTop:0},.5),s=e}e.data("isExpand",!o)}};e.find("li.collapse a").each(function(){var i=$(this),e=t[i.attr("data-cat")];$.isArray(e)&&e.length&&i.click(function(t){t.preventDefault(),o(i)})});var r,l=$(window);l.scroll(function(){a.offset().top<l.scrollTop()?(r||(r=!0,e.addClass("category-fixed"),a.css("height",e.outerHeight())),s&&o(s)):(r=!1,a.css("height",0),e.removeClass("category-fixed"))})}}]);