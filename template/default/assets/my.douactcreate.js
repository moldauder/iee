KISSY.add("iee/my.douactcreate",function(e,t,o,i,s,r){var a={};return a.init=function(){this.formEl=t.get("#doumailActForm"),this.checkObj=new r(this.formEl),this.initEvents()},a.initEvents=function(e){var t=this;o.on(t.formEl,"submit",function(e){e.halt();var o=new s.ProgressBar;o.show(),t.checkObj.validate(function(e){e&&i({url:t.formEl.action,type:"post",form:t.formEl,dataType:"json",success:function(e){t.submitSuccess(e),o.hide()},error:function(){t.submitError(),o.hide()}})})})},a.submitSuccess=function(e){var t=this.getFeedbackModal(),o=this.formEl.elements;if(o.id.value=e.id,e.success){t.setBody("豆邮活动<strong>"+o.title.value+"</strong>保存成功");var i=[{title:"回到豆邮页",href:"/doumail/all",target:"_self"}];t.setFooter(i),t.show()}else this.submitError(e)},a.submitError=function(e){var t=this.getFeedbackModal();e=e||{},t.setBody('<div class="error">豆邮活动保存失败'+(e.msg?"，<strong>"+e.msg+"</strong>":"")+"</div>"),t.setFooter([{title:"回到豆邮页",href:"/doumail/all",target:"_self"},{title:"返回编辑",act:"my.douactcreate/closeFeedback",primary:!0}]),t.show()},a.getFeedbackModal=function(){return this.feedbackModal||(this.feedbackModal=new s({title:t.text("#content h2"),cls:"postcompose-modal"})),this.feedbackModal},a.closeFeedback=function(){var e=this.feedbackModal;e&&e.hide()},a},{requires:["dom","event","ajax","iee/util.modal","iee/util.validation"]});