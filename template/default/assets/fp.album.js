KISSY.add("iee/fp.album",function(e,a,s,i,l,t){var o={};return e.mix(o,e.EventTarget),o.getModal=function(){var e=this;if(!e.modal){var i=new t({cls:"modal-album",effect:"fade"});i.on("hide",function(){e.player&&(e.player.destroy(),e.player=null)}),s.on(i.footerEl,"click",function(s){var i=s.target;a.hasClass(i,"prev")?e.prev():a.hasClass(i,"next")?e.next():a.hasClass(i,"close")&&e.hide()}),e.modal=i}return e.modal},o.show=function(s,i){var l=this,t="";e.each(s,function(e){var a=e.buylink||e.outer_url;a=a?' href="'+a+'" ':"",t+='<div class="album-item stdpost"><div class="core"><div class="photo"><a '+a+'><img src="'+e.img+'"/></a></div><div class="detail"><h2 class="title">'+e.title+'</h2><div class="content">'+e.fullcontent+'</div><div class="action">'+(a?'<a class="go-view" '+a+">点此拥有</a>":"")+'<ins class="post-share"></ins></div></div></div></div>'});var o=l.getModal();o.setBody('<div id="albumCarousel" class="album-carousel"><div class="ks-switchable-content">'+t+"</div></div>"),o.setFooter('<a class="close"></a><div id="albumTrigger" class="carousel-trigger"><a class="prev"></a><a class="next"></a></div>'),i=i||{},e.use("switchable",function(e,s){var t=new s.Carousel(a.get("#albumCarousel"),{effect:"scrollx",easing:"easeOutStrong",switchTo:i.switchTo||0});a.html(a.query("li","#albumCarousel .ks-switchable-nav"),"&bull;"),o.show(),l.player=t,l.fire("show")})},o.prev=function(){this.player&&this.player.prev()},o.next=function(){this.player&&this.player.next()},o.hide=function(){this.getModal().hide(),this.fire("hide")},o},{requires:["dom","event","anim","iee/fp.base","iee/util.modal"]});